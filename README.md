Titanic Survival Prediction with Neural Network and Rulekit
This repository contains a Python script that demonstrates a machine learning pipeline for predicting survival on the Titanic dataset using a neural network and generating interpretable rules with a custom RulekitWrapper class.
Project Overview
The script performs the following tasks:

Loads and preprocesses the Titanic dataset (Titanic-Dataset.csv).
Trains a neural network using TensorFlow/Keras to predict survival.
Uses the RulekitWrapper to generate interpretable rules from the neural network's predictions.
Evaluates the neural network and rule-based model performance.
Provides local explainability for a single test sample using the RulekitWrapper.

Prerequisites
To run the script, you need:

Python 3.8 or higher
Conda (Anaconda or Miniconda) installed
The Titanic dataset (Titanic-Dataset.csv) in the Datasets folder

Setup Instructions
1. Clone the Repository
Clone this repository to your local machine:
git clone <repository-url>
cd <repository-name>

2. Create a Conda Virtual Environment
Create a Conda environment named titanic_env with Python 3.8:
conda create -n titanic_env python=3.8

Activate the environment:
conda activate titanic_env

3. Install Required Libraries
Install the necessary Python packages using pip within the Conda environment:
pip install numpy pandas scikit-learn tensorflow rulekit

Note: The rulekit package is assumed to be the library used by RulekitWrapper. If it has a different name or is a custom package, replace rulekit with the correct package name or installation instructions.
4. Dataset
Ensure the Titanic-Dataset.csv file is placed in the Datasets directory within the repository. The script expects the dataset to contain columns: Pclass, Survived, Sex, Age, SibSp, Parch, and Fare.
Usage
Run the main script to train the neural network, generate rules, and evaluate the model:
python titanic_prediction.py

The script will:

Preprocess the dataset (handle missing values, encode categorical variables, scale features).
Train a neural network with early stopping.
Generate interpretable rules using RulekitWrapper.
Output performance metrics (accuracy, balanced accuracy) for both the neural network and rule-based model.
Provide local explainability for a single test sample.

Hyperparameters in RulekitWrapper
The RulekitWrapper class is initialized with two key hyperparameters:

max_growing (default: 2)

Description: Controls the maximum number of conditions (or splits) that can be added to a rule during the rule induction process. A lower value limits the complexity of individual rules, making them simpler and more interpretable but potentially less precise.
Impact: Setting max_growing=2 ensures that each rule has at most two conditions, balancing interpretability and predictive power.


max_rule_count (default: 3)

Description: Limits the total number of rules generated by the RulekitWrapper. A smaller number of rules improves interpretability but may reduce the model's ability to capture complex patterns.
Impact: Setting max_rule_count=3 restricts the model to generate up to three rules, prioritizing simplicity over exhaustive coverage.



Main Functions of RulekitWrapper
The RulekitWrapper class provides the following key methods:

fit(X_train, y_train)

Description: Trains the rule-based model on the provided training data (X_train) and target labels (y_train).
Input:
X_train: Training features (pandas DataFrame or NumPy array).
y_train: Training labels (pandas Series or NumPy array).


Output: Fits the internal rule induction model and prepares it for rule extraction or prediction.


get_rules()

Description: Retrieves the list of generated rules along with their weights.
Output: A list of tuples, where each tuple contains a rule (as a string or object) and its associated weight (indicating importance or confidence).


rules_statistics(X_train, y_train)

Description: Computes statistics for the generated rules, such as coverage, support, or confidence, based on the training data.
Input:
X_train: Training features.
y_train: Training labels.


Output: A summary of rule statistics, typically as a dictionary or DataFrame.


predict(X_test, rules_list)

Description: Makes predictions on the test data (X_test) using the provided list of rules.
Input:
X_test: Test features (pandas DataFrame or NumPy array).
rules_list: List of rules obtained from get_rules().


Output: Predicted labels for the test data.


local_explainability(sample)

Description: Provides an explanation for a single test sample by identifying which rules apply and how they contribute to the prediction.
Input:
sample: A single test sample (pandas Series or NumPy array).


Output: A detailed explanation, typically as a string or structured format, describing the rules and weights applied to the sample.



Expected Output
When you run the script, it will output:

Neural network performance:
Training accuracy and balanced accuracy.
Test accuracy and balanced accuracy.


Rule-based model results:
Total number of rules generated.
Details of each rule and its weight.
Rule statistics (e.g., coverage, support).
Fidelity score (accuracy of rule-based predictions compared to neural network predictions).
Classifier and rule-based model accuracies, along with the drop in accuracy.


Local explainability for a single test sample.

Notes

The script assumes the RulekitWrapper class is available in the repository or installed as a dependency. If it is a custom implementation, ensure it is included in the repository.
The neural network uses a simple architecture with three hidden layers (128, 64, and 32 neurons) and early stopping to prevent overfitting.
The dataset preprocessing includes handling missing values (using median imputation for Age and Fare), encoding categorical variables (Pclass, Sex), and scaling features using MinMaxScaler.
